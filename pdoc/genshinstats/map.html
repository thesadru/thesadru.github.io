<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>genshinstats.map API documentation</title>
<meta name="description" content="The official genshin map â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}#lunr-search{width:100%;font-size:1em;padding:6px 9px 5px 9px;border:1px solid silver}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>genshinstats.map</code></h1>
</header>
<section id="section-intro">
<p>The official genshin map</p>
<p>Gets data from the official genshin map such as categories, points and similar.</p>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/thesadru/genshinstats/blob/master/genshinstats/map.py#L1-L74" class="git-link">Browse git</a>
</summary>
<pre><code class="python">&#34;&#34;&#34;The official genshin map

Gets data from the official genshin map such as categories, points and similar.
&#34;&#34;&#34;
import json
from typing import Any, Dict, List
from urllib.parse import urljoin

from .caching import permanent_cache
from .genshinstats import fetch_endpoint

OS_MAP_URL = &#34;https://api-os-takumi-static.mihoyo.com/common/map_user/ys_obc/v1/map/&#34;

__all__ = [
    &#34;fetch_map_endpoint&#34;,
    &#34;get_map_image&#34;,
    &#34;get_map_icons&#34;,
    &#34;get_map_labels&#34;,
    &#34;get_map_locations&#34;,
    &#34;get_map_points&#34;,
    &#34;get_map_tile&#34;,
]


def fetch_map_endpoint(endpoint: str, **kwargs) -&gt; dict[str, Any]:
    &#34;&#34;&#34;Fetch an enpoint from mihoyo&#39;s webstatic map api.

    Only currently liyue is supported.

    Takes in an endpoint url which is joined with the base url.
    A request is then sent and returns a parsed response.
    &#34;&#34;&#34;
    kwargs.setdefault(&#34;params&#34;, {}).update({&#34;map_id&#34;: 2, &#34;app_sn&#34;: &#34;ys_obc&#34;, &#34;lang&#34;: &#34;en-us&#34;})
    url = urljoin(OS_MAP_URL, endpoint)
    return fetch_endpoint(url, cookie={}, **kwargs)


@permanent_cache()
def get_map_image() -&gt; str:
    &#34;&#34;&#34;Get the url to the entire map image&#34;&#34;&#34;
    data = fetch_map_endpoint(&#34;info&#34;)[&#34;info&#34;][&#34;detail&#34;]
    return json.loads(data)[&#34;slices&#34;][0][0][&#34;url&#34;]

@permanent_cache()
def get_map_icons() -&gt; Dict[int, str]:
    &#34;&#34;&#34;Get all icons for the map&#34;&#34;&#34;
    data = fetch_map_endpoint(&#34;spot_kind/get_icon_list&#34;)[&#34;icons&#34;]
    return {i[&#34;id&#34;]: i[&#34;url&#34;] for i in data}

@permanent_cache()
def get_map_labels() -&gt; List[Dict[str, Any]]:
    &#34;&#34;&#34;Get labels and label categories&#34;&#34;&#34;
    return fetch_map_endpoint(&#34;label/tree&#34;)[&#34;tree&#34;]

def get_map_locations() -&gt; List[Dict[str, Any]]:
    &#34;&#34;&#34;Get all locations on the map&#34;&#34;&#34;
    return fetch_map_endpoint(&#34;map_anchor/list&#34;)[&#34;list&#34;]

def get_map_points() -&gt; List[Dict[str, Any]]:
    &#34;&#34;&#34;Get points on the map&#34;&#34;&#34;
    return fetch_map_endpoint(&#34;point/list&#34;)[&#34;point_list&#34;]

def get_map_tile(x: int, y: int, width: int, height: int, resolution: int = 1, image: str = None) -&gt; str:
    &#34;&#34;&#34;Gets a map tile at a position

    You may set an x, y, width and height of the resulting image
    however you shoudl prefer to use multiples of 256 because they are cached
    on the mihoyo servers.

    Resolution dictates the resolution of the image as a percentage. 100 is highest and 0 is lowest.
    You should pick values from 100, 50, 25 and 12.5
    &#34;&#34;&#34;
    image = image or get_map_image()
    return image + f&#34;?x-oss-process=image/resize,p_{round(resolution)}/crop,x_{x},y_{y},w_{width},h_{height}&#34;</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="genshinstats.map.fetch_map_endpoint"><code class="name flex">
<span>def <span class="ident">fetch_map_endpoint</span></span>(<span>endpoint:Â str, **kwargs) â€‘>Â dict</span>
</code></dt>
<dd>
<div class="desc"><p>Fetch an enpoint from mihoyo's webstatic map api.</p>
<p>Only currently liyue is supported.</p>
<p>Takes in an endpoint url which is joined with the base url.
A request is then sent and returns a parsed response.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/thesadru/genshinstats/blob/master/genshinstats/map.py#L25-L35" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def fetch_map_endpoint(endpoint: str, **kwargs) -&gt; dict[str, Any]:
    &#34;&#34;&#34;Fetch an enpoint from mihoyo&#39;s webstatic map api.

    Only currently liyue is supported.

    Takes in an endpoint url which is joined with the base url.
    A request is then sent and returns a parsed response.
    &#34;&#34;&#34;
    kwargs.setdefault(&#34;params&#34;, {}).update({&#34;map_id&#34;: 2, &#34;app_sn&#34;: &#34;ys_obc&#34;, &#34;lang&#34;: &#34;en-us&#34;})
    url = urljoin(OS_MAP_URL, endpoint)
    return fetch_endpoint(url, cookie={}, **kwargs)</code></pre>
</details>
</dd>
<dt id="genshinstats.map.get_map_icons"><code class="name flex">
<span>def <span class="ident">get_map_icons</span></span>(<span>) â€‘>Â Dict[int,Â str]</span>
</code></dt>
<dd>
<div class="desc"><p>Get all icons for the map</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/thesadru/genshinstats/blob/master/genshinstats/map.py#L44-L48" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@permanent_cache()
def get_map_icons() -&gt; Dict[int, str]:
    &#34;&#34;&#34;Get all icons for the map&#34;&#34;&#34;
    data = fetch_map_endpoint(&#34;spot_kind/get_icon_list&#34;)[&#34;icons&#34;]
    return {i[&#34;id&#34;]: i[&#34;url&#34;] for i in data}</code></pre>
</details>
</dd>
<dt id="genshinstats.map.get_map_image"><code class="name flex">
<span>def <span class="ident">get_map_image</span></span>(<span>) â€‘>Â str</span>
</code></dt>
<dd>
<div class="desc"><p>Get the url to the entire map image</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/thesadru/genshinstats/blob/master/genshinstats/map.py#L38-L42" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@permanent_cache()
def get_map_image() -&gt; str:
    &#34;&#34;&#34;Get the url to the entire map image&#34;&#34;&#34;
    data = fetch_map_endpoint(&#34;info&#34;)[&#34;info&#34;][&#34;detail&#34;]
    return json.loads(data)[&#34;slices&#34;][0][0][&#34;url&#34;]</code></pre>
</details>
</dd>
<dt id="genshinstats.map.get_map_labels"><code class="name flex">
<span>def <span class="ident">get_map_labels</span></span>(<span>) â€‘>Â List[Dict[str,Â Any]]</span>
</code></dt>
<dd>
<div class="desc"><p>Get labels and label categories</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/thesadru/genshinstats/blob/master/genshinstats/map.py#L50-L53" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@permanent_cache()
def get_map_labels() -&gt; List[Dict[str, Any]]:
    &#34;&#34;&#34;Get labels and label categories&#34;&#34;&#34;
    return fetch_map_endpoint(&#34;label/tree&#34;)[&#34;tree&#34;]</code></pre>
</details>
</dd>
<dt id="genshinstats.map.get_map_locations"><code class="name flex">
<span>def <span class="ident">get_map_locations</span></span>(<span>) â€‘>Â List[Dict[str,Â Any]]</span>
</code></dt>
<dd>
<div class="desc"><p>Get all locations on the map</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/thesadru/genshinstats/blob/master/genshinstats/map.py#L55-L57" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_map_locations() -&gt; List[Dict[str, Any]]:
    &#34;&#34;&#34;Get all locations on the map&#34;&#34;&#34;
    return fetch_map_endpoint(&#34;map_anchor/list&#34;)[&#34;list&#34;]</code></pre>
</details>
</dd>
<dt id="genshinstats.map.get_map_points"><code class="name flex">
<span>def <span class="ident">get_map_points</span></span>(<span>) â€‘>Â List[Dict[str,Â Any]]</span>
</code></dt>
<dd>
<div class="desc"><p>Get points on the map</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/thesadru/genshinstats/blob/master/genshinstats/map.py#L59-L61" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_map_points() -&gt; List[Dict[str, Any]]:
    &#34;&#34;&#34;Get points on the map&#34;&#34;&#34;
    return fetch_map_endpoint(&#34;point/list&#34;)[&#34;point_list&#34;]</code></pre>
</details>
</dd>
<dt id="genshinstats.map.get_map_tile"><code class="name flex">
<span>def <span class="ident">get_map_tile</span></span>(<span>x:Â int, y:Â int, width:Â int, height:Â int, resolution:Â intÂ =Â 1, image:Â strÂ =Â None) â€‘>Â str</span>
</code></dt>
<dd>
<div class="desc"><p>Gets a map tile at a position</p>
<p>You may set an x, y, width and height of the resulting image
however you shoudl prefer to use multiples of 256 because they are cached
on the mihoyo servers.</p>
<p>Resolution dictates the resolution of the image as a percentage. 100 is highest and 0 is lowest.
You should pick values from 100, 50, 25 and 12.5</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/thesadru/genshinstats/blob/master/genshinstats/map.py#L63-L74" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def get_map_tile(x: int, y: int, width: int, height: int, resolution: int = 1, image: str = None) -&gt; str:
    &#34;&#34;&#34;Gets a map tile at a position

    You may set an x, y, width and height of the resulting image
    however you shoudl prefer to use multiples of 256 because they are cached
    on the mihoyo servers.

    Resolution dictates the resolution of the image as a percentage. 100 is highest and 0 is lowest.
    You should pick values from 100, 50, 25 and 12.5
    &#34;&#34;&#34;
    image = image or get_map_image()
    return image + f&#34;?x-oss-process=image/resize,p_{round(resolution)}/crop,x_{x},y_{y},w_{width},h_{height}&#34;</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<form>
<input id="lunr-search" name="q" placeholder="ðŸ”Ž Search ..." aria-label="Search"
disabled minlength="2">
</form>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.css" integrity="sha512-j1u8eUJ4f23xPPxwOrLUPQaCD2dwzNqqmDDcWS4deWsMv2ohLqmXXuP3hU7g8TyzbMSakP/mMqoNBYWj8AEIFg==" crossorigin>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.15.3/tingle.min.js" integrity="sha512-plGUER9JkeEWPPqQBE4sdLqBoQug5Ap+BCGMc7bJ8BXkm+VVj6QzkpBz5Yv2yPkkq+cqg9IpkBaGCas6uDbW8g==" crossorigin></script>
<style>
.modal-dialog iframe {
width: 100vw;
height: calc(100vh - 80px);
}
@media screen and (min-width: 700px) {
.modal-dialog iframe {
width: 70vw;
height: 80vh;
}
}
.modal-dialog .tingle-modal-box {width: auto;}
.modal-dialog .tingle-modal-box__content {padding: 0;}
</style>
<script>
const input = document.getElementById('lunr-search');
input.disabled = false;
input.form.addEventListener('submit', (ev) => {
ev.preventDefault();
const url = new URL(window.location);
url.searchParams.set('q', input.value);
history.replaceState({}, null, url.toString());
search(input.value);
});
const query = new URL(window.location).searchParams.get('q');
if (query)
search(query);
function search(query) {
const url = '../doc-search.html#' + encodeURIComponent(query);
new tingle.modal({
cssClass: ['modal-dialog'],
onClose: () => {
const url = new URL(window.location);
url.searchParams.delete('q');
history.replaceState({}, null, url.toString());
setTimeout(() => input.focus(), 100);
}
}).setContent('<iframe src="' + url + '"></iframe>').open();
}
</script>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="genshinstats" href="index.html">genshinstats</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="genshinstats.map.fetch_map_endpoint" href="#genshinstats.map.fetch_map_endpoint">fetch_map_endpoint</a></code></li>
<li><code><a title="genshinstats.map.get_map_icons" href="#genshinstats.map.get_map_icons">get_map_icons</a></code></li>
<li><code><a title="genshinstats.map.get_map_image" href="#genshinstats.map.get_map_image">get_map_image</a></code></li>
<li><code><a title="genshinstats.map.get_map_labels" href="#genshinstats.map.get_map_labels">get_map_labels</a></code></li>
<li><code><a title="genshinstats.map.get_map_locations" href="#genshinstats.map.get_map_locations">get_map_locations</a></code></li>
<li><code><a title="genshinstats.map.get_map_points" href="#genshinstats.map.get_map_points">get_map_points</a></code></li>
<li><code><a title="genshinstats.map.get_map_tile" href="#genshinstats.map.get_map_tile">get_map_tile</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>